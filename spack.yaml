# This is a Spack Environment file.
#
# It describes a set of packages to be installed, along with
# configuration settings.
spack:
  # definitions:
    # TODO: _name and _version are required reserved definitions that inform build-cd deployments, and have no effect otherwise
    # - _name: [DEPLOYMENT_NAME_HERE]
    # - _version: [DEPLOYMENT_VERSION_HERE]

    # TODO: This section is used primarily to provide variations to a model based on deployment target. Delete if not required.
    # This is the root spack bundle that contains the model
    # - ROOT_PACKAGE:
    #   - MODEL@git.GIT_REF=SPACK_VERSION

    # Mutually-exclusive Compiler and Target definitions (assumes DEPLOYMENT_TARGET set)
    # - when: env['DEPLOYMENT_TARGET'] == 'Gadi'
    #   compiler_target: ['%intel@19.0.5.281 target=x86_64_v4']
    # More mutually-exclusive definitions can be made...
    # Default
    # - when: "'DEPLOYMENT_TARGET' not in env"
    #   compiler_targets: ['intel@2021.2.0 target=x86_64']

    # This is where the single definitions of ROOT_PACKAGE and compiler/target are
    # matrixed together to form a single spec: MODEL@git.GIT_REF=SPACK_VERSION %intel@2021.2.0 target=x86_64
    # - ROOT_SPEC:
    #   - matrix:
    #     - [$ROOT_PACKAGE]
    #     - [$%compiler_target]

  specs:
    # The root Spack Bundle Recipe (SBR) for the model
    # TODO: Replace the MODEL if there is only one deployment target
    # - MODEL
    # Alternatively, if there are multiple deployment targets that require
    # different compilers/variants, use the above definitions section and:
    # - $ROOT_SPEC
  packages:
    # Specification of dependency versions and variants. CI/CD requires that
    # the first element of the require is only a version:
    # TODO: Specify versions and variants of dependencies as required.
    # openmpi:
    #   require:
    #   - '@4.1.5'

    # Compilers
    # TODO: For compilers used in this deployment, specify versions as required.
    #       If changing compiler families, don't forget to update the 'all' section below.

    # Specifications that apply to all packages
    all:
      # TODO: Specify compiler toolchain/targets for all packages
      # require:
      # - '%access_intel'
      # - 'target=x86_64'
  view: true
  concretizer:
    unify: true
  # modules:
  #   overridden module includes, projections, etc, if needed
  #   we inject these in build-cd now, but custom ones can be added additionally here
  # config:
  #   overridden spack configurations, if needed. Preference is to use custom configurations scopes in
  #   spack-config's custom/cd/SCOPE, referenced in the config/versions.json's custom-scopes field.
  # mirrors:
  #   overridden spack package tarball directories, if needed
  # repos:
  #   overridden repo sources, if needed
